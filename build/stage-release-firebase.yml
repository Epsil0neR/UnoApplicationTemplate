parameters:
  applicationEnvironment: '' # e.g. "Staging", "Production"
  deploymentEnvironment: '' # e.g. "GooglePlay", "AppStore", "Firebase"
  androidVariableGroup: ''
  iosVariableGroup: ''

jobs:
- deployment: Firebase_Android
  pool:
    vmImage: $(linuxHostedAgentImage)
  variables:
  - name: artifactName
    value: $(AndroidArtifactName)_${{ parameters.applicationEnvironment }}
  - name: releaseNotesArtifactName
    value: ReleaseNotes_${{ parameters.applicationEnvironment }}
  - group: ${{ parameters.androidVariableGroup }}
  environment: ${{ parameters.deploymentEnvironment }}
  strategy:
      runOnce:
        deploy:
          steps:
          - template: ./templates/firebase-deploy.yml
            parameters:
              fileName: '$(ApplicationIdentifier)-Signed.apk'

- deployment: Firebase_iOS
  pool:
    vmImage: $(linuxHostedAgentImage)
  variables:
  - name: artifactName
    value: $(iOSArtifactName)_${{ parameters.applicationEnvironment }}
  - name: releaseNotesArtifactName
    value: ReleaseNotes_${{ parameters.applicationEnvironment }}
  - group: ${{ parameters.iosVariableGroup }}
  environment: ${{ parameters.deploymentEnvironment }}
  strategy:
    runOnce:
      deploy:
        steps:
        - template: ./templates/firebase-deploy.yml
          parameters:
              fileName: '$(SolutionName).Mobile.ipa'